Filtered squarewave generation using 4-stage bi-directional single-pole IIR filter with resonance emulated